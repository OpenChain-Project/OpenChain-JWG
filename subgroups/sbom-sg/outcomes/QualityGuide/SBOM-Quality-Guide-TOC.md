# SBOM品質向上ガイド

## 目次

1. [はじめに](#1-はじめに)  
2. [目的と適用範囲](#2-目的と適用範囲)  
3. [用語と定義](#3-用語と定義)  
4. [基本要求事項](#4-基本要求事項)  
5. [SBOM品質評価と改善策](#5-SBOM品質評価と改善策)  
 5.1 [情報記述の正確性および一貫性の確保](#51-情報記述の正確性および一貫性の確保)  
 5.2 [コンポーネント粒度の標準化と正規化](#52-コンポーネント粒度の標準化と正規化)  
 5.3 [ソース情報の補完と透明性向上](#53-ソース情報の補完と透明性向上)  
 5.4 [脆弱性連携及びリスクマネジメントの強化](#54-脆弱性連携及びリスクマネジメントの強化)  
 5.5 [上流・下流間の情報統合と連携強化](#55-上流下流間の情報統合と連携強化)  
 5.6 [改ざん検知と変更管理体制の構築](#56-改ざん検知と変更管理体制の構築)  
 5.7 [記述範囲の明確化と責任所在の定義](#57-記述範囲の明確化と責任所在の定義)  
 5.8 [部品間関係性の統一的表現](#58-部品間関係性の統一的表現)  
6. [自動化戦略と運用プロセス](#6-自動化戦略と運用プロセス)  
 6.1 [自動検証ツールの導入](#61-自動検証ツールの導入)  
 6.2 [変換プロセスと正規化](#62-変換プロセスと正規化)  
 6.3 [運用負荷軽減と人的レビューの統合](#63-運用負荷軽減と人的レビューの統合)  
7. [ガイドの運用と管理](#7-ガイドの運用と管理)  
 7.1 [ガイド更新プロセス](#71-ガイド更新プロセス)  
 7.2 [改訂履歴の管理と文書化](#72-改訂履歴の管理と文書化)  
8. [参考文献・関連資料](#8-参考文献関連資料)

#### Appendix-1. [SBOM サンプル](#appendix-1-sbom-サンプル)
#### Appendix-2. [5章の項目記載用テンプレート](#appendix-2-5章の項目記載用テンプレート)

---

## 各章概要

### 1. はじめに  
本章では、SB」存関係など、本ガイドで使用する専門用語の定義を統一し、混乱や誤解が生じないよう基盤知識を整理する。

### 4. 基本要求事項  
[OpenChain Telco SBOM Guide Version 1.1の 3.要求要件](https://github.com/OpenChain-Project/Telco-WG/blob/main/OpenChain-Telco-SBOM-Guide_JP.md#3-%E8%A6%81%E6%B1%82%E8%A6%81%E4%BB%B6) を継承する。

### 5. SBOM品質評価と改善策  
本章では、OpenChain SBOM SG 内の議論で提起された課題に基づいて、SBOMの質を評価および改善する具体的なチェック項目と解決策を体系的に整理し、ベストプラクティスとして記載する。  
[5章の項目記載用テンプレート](#appendix-2-5章の項目記載用テンプレート) を用いて追加する。  

> **以下は、SBOM sg 内で議論されたものの例**  
> これら議論の内容から重複するものをマージしてピックアップした  
> [2025/02/03](https://github.com/OpenChain-Project/OpenChain-JWG/blob/master/subgroups/sbom-sg/meetings/20250203.md)  
> [2025/02/17](https://github.com/OpenChain-Project/OpenChain-JWG/blob/master/subgroups/sbom-sg/meetings/20250217.md)  
> [2025/02/25](https://github.com/OpenChain-Project/OpenChain-JWG/blob/master/subgroups/sbom-sg/meetings/20250225.md)  
> [2025/03/05](https://github.com/OpenChain-Project/OpenChain-JWG/blob/master/subgroups/sbom-sg/meetings/20250305.md)  
> [2025/03/24](https://github.com/OpenChain-Project/OpenChain-JWG/blob/master/subgroups/sbom-sg/meetings/20250324.md)

#### 5.1 情報記述の正確性および一貫性の確保  

##### 5.1.1. 課題の概要  
パッケージ名、バージョン、サプライヤー名などの記述について、各部署やツールごとに表記方法が異なるため、情報の正確性と一貫性が欠如しています。統一された基準がない場合、SBOMの自動解析や脆弱性マッチング等において、正確な判定が困難になる。

##### 5.1.2. 改善策  
- 業界標準や社内ルールに基づいた統一表記ルールを策定し、具体例（正規表現などのフォーマット例）を広く共有。  
- 自動検証ツールを提供、各パッケージ名・バージョン・サプライヤー名の記載がルールに準拠しているかをチェックする仕組みを構築。  
- 定期的なレビューおよびフィードバックプロセスを整備し、記載基準の変更や改善策の継続的なアップデートを実施。

##### 5.1.3. 評価方法  
- 自動検証ツールによるルール違反件数の定量的なモニタリングを実施し、改善前後の誤記や不整合件数の減少率を評価。  
- 定期的に、各記述項目が統一ルールに沿って記載されているかをランダムにチェックし、合格率を評価。  
- フィードバックプロセス内で、ツールやルールの更新による運用効果を各社各部門間などで共有し、改善効果の定性的評価を合わせて実施。

##### 5.1.4. リスクと留意事項  
- 自動検証ツールのルール設定が不十分な場合、例外ケースや特殊な記述に対する対応が不完全になる可能性がある。  
- ルールの改定や正規表現の例示が現場実態と乖離している場合、過度な自動チェックによって正当な情報が誤検知されるリスクがある。  
- ツールやプロセスは完全自動化が難しく、最終的な精査や例外事項の対応は人的レビューが必要となる点を留意する必要がある.

#### 5.2 コンポーネント粒度の標準化と正規化  
担当: 田中さん  
- ファイル単位またはパッケージ単位といった情報記述の粒度を明確にし、複数のSBOM間で情報統合を図るための変換ツールの利用方法を整理。

SBOMに含まれるコンポーネントの単位には、ファイルとパッケージの2種類が想定される。
その場合、サプライチェーンの中でコンポーネントの粒度が異なるSBOMをやり取りする可能性がある。
SBOMを1つのファイルにマージして提供するか、複数のファイルで提供するかはどちらでもよいとして、サプライチェーンで粒度が一貫している必要があるのか、粒度の異なるSBOMを矛盾なく依存関係を記述することができるのかという課題がある。

この課題を検証するために以下の条件で考えた。
- 前提条件
  1. VendorがアプリAをバイナリとSBOMでMakerに提供する
  1. MakerがアプリAとOSSを含む商品Xをユーザに提供する
  1. アプリAはMakerが商品Xで使用しているOSSに依存している
 
上記の条件で、アプリAのSBOMの粒度がバイナリファイルまたはバイナリパッケージの場合と、Makerが最終商品のSBOMの粒度をバイナリファイルまたはバイナリパッケージでSBOMを生成する場合の組み合わせを表にした。

|||Makerがユーザに提供するSBOM||
|-|-|-|-|
||コンポーネントの単位|ファイル|パッケージ|
|Vendorが提供するアプリAのSBOM|ファイル|ファイル単位|アプリAが依存するOSSのファイル情報をパッケージ情報に変換してアプリAのみファイル単位にする|
||パッケージ|アプリAのパッケージからファイルを分解してファイル単位にする|パッケージ単位|

結論としては、上記の表のとおり、どのケースでも対応は可能。
ただし、組み合わせによってMakerの作業の手間に違いが出る。

#### 5.3 ソース情報の補完と透明性向上  
担当: 武山さん
- バイナリ提供時にもソースファイル一覧、ハッシュ値、ライセンス情報など補完すべき情報を必須項目化するなど、自動抽出プロセスを導入する方針を示す。

#### 5.4 脆弱性連携及びリスクマネジメントの強化  
担当: 細見さん  
- 各コンポーネント情報と脆弱性情報（CVE等）の連携方法、及びリスク評価を自動的にマッピングする仕組みの導入方法を規定する。  
- 脆弱性情報をどのようにSBOMの各エントリに反映させ、何を結論として確定するかが明確に定義されていない  
- 法規制や社内ルールとの整合性を取るため、最終的には人手による確認やメタデータの調整が不可欠となっている  
- CPEで仕様として定められた形式に準拠することが推奨されているが、実際には各社が提供する情報によっては、必要な項目が欠落していたり、オプションの部分に独自の解釈が加えられることがある

#### 5.5 上流・下流間の情報統合と連携強化  
担当: 余保さん  
- ベンダーが提供するSBOMと組立メーカー内部のSBOMの整合性を確保するため、共通リポジトリの運用、定期的なクロスチェック、及び自動差分比較ツールの活用を推奨。

#### 5.6 改ざん検知と変更管理体制の構築  
担当: 平能さん  
- SBOM生成直後のデジタル署名やハッシュ値の付与、変更履歴管理、自動監視システムによる改ざん検知の仕組みを具体策として提示する。  

#### 5.7 記述範囲の明確化と責任所在の定義  
担当: 小保田  
- ソースコード、バイナリ、ファームウェア、ハードウェア情報など、SBOMに含める情報範囲を明確にするとともに、作成者（Creator）やパッケージ提供者（packageSupplier）など各責任所在を明示する。

#### 5.8 部品間関係性の統一的表現  
担当: 大和田さん  
- コンポーネント間の依存関係や関連性（例：dependsOn、contains、generates等）の統一的記述ルールを定義し、テンプレートおよび自動検証ツールによる整合性チェックの方法を明示する。  

#### 5.9 依存関係把握とパッケージ取得手法の問題
担当: 伊藤さん  
- ソースコードとパッケージ両方から依存関係を取得することで、重複や冗長な情報が混在し、全体の依存関係把握が難しくなる  
- ロックファイルやパッケージマネージャーのログだけで解析した場合、最新の依存関係や推移的な依存関係が完全に反映されない場合がある  
- 解析手法に統一性や自動化が不足しており、正確な依存関係抽出と整合性の維持に手動の補完が必要となっている

#### 5.10 ツール間の連携性と柔軟性の不足  
担当: 濵さん  
- ORT（OSS Review Toolkit）などのツールは、デフォルト(ORT だと ScanCode)以外のスキャンツール（例：FOSSologyなど）も利用可能だが、切り替え方法など実際に試した例はほとんどなく、各ツールに互換性があるのかどうかが良く知られていない  
- ツール間での連携を強化するためのドキュメントやルールが不十分であり、ユーザー側で各ツールの特性を理解し調整する必要がある  

#### 5.11 ツールの保守・更新状況とコミュニティの連携
担当: 濵さん  
- 利用される一部ツールのメンテナやコントリビュータが足りておらず、メンテナンス状況が不十分  
- 商用ツールとの互換性や統一出力形式を実現するための標準ガイドラインや連携策が不足  

#### 5.x ...

> **TBD: 6章を記載するかどうかについては、5章をまとめた後に議論する**  

> ### 6. 自動化戦略と運用プロセス  
> 本章では、SBOMの品質向上に寄与する自動化可能なプロセスと、さらに必要な人的レビューとの統合運用について述べる。
> 
> #### 6.1 自動検証ツールの導入  
> - 命名規則、バージョン形式、必須項目有無の自動チェックを実現するツールの選定と運用方針を策定。  
> 
> #### 6.2 変換プロセスと正規化  
> - 異なるフォーマットの一貫性を確保するための変換ツール及びデータ正規化プロセスの設計と運用手法を定義。
> 
> #### 6.3 運用負荷軽減と人的レビューの統合  
> - 初期の自動チェックに続き、例外ケースやあいまいな情報に対して人的レビューを組み合わせるハイブリッド運用フローの設計と導入方法を示す。

### 7. ガイドの運用と管理  
本章は、本ガイド自体の管理に焦点を当て、定期的な見直し、更新、および改訂履歴の管理プロセスについて記述。ここでは、SBOMそのものの運用ではなく、あくまで本SBOM品質向上ガイドの保守管理手法を記す。

#### 7.1 ガイド更新プロセス  
- 業界標準や自動化ツールの進展、及びユーザーフィードバックに基づき、本ガイドの定期レビューと改訂プロセスを策定。  
- 更新時の関係者間の調整手続きや承認プロセスも明確化。

#### 7.2 改訂履歴の管理と文書化  
- 各バージョンごとの変更内容、更新日、影響範囲を詳細に記録するための履歴管理方法と文書化のルールを定義します。  
- ガイド自身の真正性と透明性を維持するための管理策を含めます。

### 8. 参考文献・関連資料  
- [OpenChain-Telco-SBOM-Guide](https://github.com/OpenChain-Project/Telco-WG) に加え、SPDX、NTIA SBOM Minimum Elementsなどの国際規格および関連文献の参照先を掲載。

---

### Appendix-1. SBOM サンプル  

ここには、仕様上正しく、また実際に企業などで利用されている、値の内容まで含めた、JSON Formatで記述されたSBOMのサンプルファイルを記載する。  
SPDX 及び CycloneDX の仕様に詳しい人々にレビューをしてもらう必要がある。  

### Appendix-2. 5章の項目記載用テンプレート

ここに記載のあるテンプレートを用いて、5章の各項目を追加していく。  
ガイドにそれら項目を追加するべきかどうか、また記載内容そのものについて、GitHub Discussion もしくは Issues を起こし議論する。(TBD: 議論プロセス)  

#### 5.x [対象項目名]（例：5.1 情報記述の正確性および一貫性の確保）

##### 5.x.1. 課題の概要
- 対象課題の現状と理想状態を簡潔に説明  
- 課題の背景や影響範囲の概要も記載する  
- 図などを埋め込んで説明しても良い

##### 5.x.2. 改善策
- 課題解決のための具体的な対策（例：自動チェックツール導入、記述ルールの統一、プロセスの定義など）  
- 改善策の実施手順

##### 5.x.3. 評価方法
- 改善効果を示す指標（例：自動チェックツールにより何をチェックするのか、またチェックリストの項目とその達成率を指標とする、など）  
- 定量・定性評価の実施方法と評価サイクル

##### 5.x.4. リスクと留意事項
- 改善策実施に伴うリスク、例外対応、補足事項
